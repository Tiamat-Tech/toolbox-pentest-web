# 🐳 Technical hints about container

> 📡 **Note**: Use the TOC provided by the GitHub MD file rendering named `Outline`.

🏡 [Back to home](README.md).

## Commands

💻 Utility commands when acting with a container from its container host:

```shell
# Get the IP address of the container identified by CONTAINER_ID
docker inspect -f '{{range.NetworkSettings.Networks}}{{.IPAddress}}{{end}}' [CONTAINER_ID]
```

💻 Utility commands to obtain information from inside a container:

```shell
# Identify the container technology used by the container host
# Into the example below, it show that "docker" is used due to the folder name in path "/docker/"
$ cat /proc/1/cgroup
15:name=systemd:/docker/f77ac...
14:misc:/docker/f77ac...
# Get location where the filesystem in located on the container host
$ mount
overlay on / type overlay (rw,relatime,
  lowerdir=/var/lib/docker/overlay2/l/PAPVX2QCGBAUHWNAAZ4FDIO3IS:/var/lib/docker/overlay2/l/4W2BRW33ORZQRLUUVZROYVCYKH,
  upperdir=/var/lib/docker/overlay2/a7b8fb4aca9708e687b3000c697b46e629b939575384d0eac5e6e5a86ee6c20e/diff,
  workdir=/var/lib/docker/overlay2/a7b8fb4aca9708e687b3000c697b46e629b939575384d0eac5e6e5a86ee6c20e/work)
# List the group of capabilities given to the container
$ grep Cap /proc/self/status
CapInh: 0000000000000000
CapPrm: 00000000a80425fb
CapEff: 00000000a80425fb
CapBnd: 00000000a80425fb
CapAmb: 0000000000000000
```

💡 To see the detail of a group of capabilities, execute the following commands on a **linux host** (documentation about [capabilities](https://man7.org/linux/man-pages/man7/capabilities.7.html)):

```shell
# Parameter is the ID of the group of capabilities returned by the command "grep Cap /proc/self/status"
capsh --decode="00000000a80425fb"
0x00000000a80425fb=cap_chown,cap_dac_override,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,
                   cap_net_bind_service,cap_net_raw,cap_sys_chroot,cap_mknod,cap_audit_write,cap_setfcap
```

## Images

📐 The objective is to leverage the containerization to have **a collection of quick sandboxes environment to test some specific behavior on a specific OS/runtime**, for example, during a code review on an old version of a runtime (like PHP5).

💻 Build command reminder for images:

```shell
docker rmi -f righettod/[BoxName]
docker build --force-rm -t righettod/[BoxName] -f Dockerfile .
docker run --rm -v "[LOCAL_FOLDER_PATH]:/share" -i -t righettod/[BoxName]
```

### PHP 5.x

📦 Docker Ubuntu 14 image with PHP 5.x environment:

```dockerfile
FROM ubuntu:14.04
RUN apt-get update -y
RUN apt-get install -y curl git highlight nano openssl php5 php5-mcrypt php5-sqlite php5-xsl php5-json php-http-request2 phpunit software-properties-common zsh
RUN php5enmod mcrypt
RUN sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)" "" --unattended
RUN echo "alias cat_colorized='highlight -O ansi --force'" >> /root/.zshrc
ENTRYPOINT ["/bin/zsh"]
```

### Ruby 2.x

📦 The following images can be used:

```shell
# Once in the container, you can install software 
# via "apt-get update; apt-get install nano ..."
docker run -it ruby:2 /bin/bash
```
