#!/bin/bash
#############################################################################################################
# Script to identify the type of an AWS Access Key provided.
#
# Reference:
#    https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_identifiers.html#identifiers-unique-ids
#############################################################################################################
if [ "$#" -lt 1 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [AWS_KEY]"
    echo ""
    echo "Call example:"
    echo "    $script_name 'ANPAxxx'"
    exit 1
fi
key_prefix=$(echo $1 | cut -c1-4)
case ${key_prefix^^} in
  ABIA)
    echo "AWS STS Service Bearer Token"
    ;;
  ACCA)
    echo "Context-Specific Credential"
    ;;
  AGPA)
    echo "User Group"
    ;;
  AIDA)
    echo "IAM User"
    ;;
  AIPÃ„)
    echo "EC2 Instance Profile"
    ;;    
  AKIA)
    echo "Permanent Access Key"
    ;;        
  ANPA)
    echo "Managed Policy"
    ;;            
  ANVA)
    echo "Version in a managed policy"
    ;;                
  APKA)
    echo "Public key"
    ;;                 
  AROA)
    echo "Role"
    ;;        
  ASCA)
    echo "Certificate"
    ;;                         
  ASIA)
    echo "Temporary (AWS STS) Access Key" 
    ;;      
  *)
    echo "Unknown Type!"
    ;;
esac

