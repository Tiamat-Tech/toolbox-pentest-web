#!/bin/bash
###########################################################
# Script to generate a valid NMAP grepable output file
# from a valid MASSCAN grepable output file.
###########################################################
if [ "$#" -lt 1 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [MASSCAN_GREPABLE_OUTPUT_FILE]"
    echo ""
    echo "Call example:"
    echo "    $script_name masscan-output.txt"
    exit 1
fi
function write_step (){
    echo -e "\e[93m[+] $1\e[0m"
}
masscan_file="$1"
nmap_file="NMAP-$1"
write_step "Validate masscan file provided..."
marker=$(grep -Eic "masscan\s+[0-9a-z.]+\s+scan\s+initiated" $masscan_file)
if [ $marker -ne 1 ]
then
	echo "Invalid masscan file!"
	exit 1
else
	echo "OK."
fi
write_step "Generate the nmap file..."
cat $masscan_file | sed -E 's/^Timestamp:\s+[0-9]+\s*//g' > $nmap_file
echo "Done."
ls -l $nmap_file
