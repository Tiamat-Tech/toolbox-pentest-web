#!/bin/bash
###########################################################
# Script to format a Base64 encoded string containing a
# X509 certificate to a PEM representation file.
###########################################################
if [ "$#" -lt 1 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [BASE64_CERT_STRING]"
    echo ""
    echo "Call example:"
    echo "    $script_name 'MIIEaDCCA...'"
    exit 1
fi
function write_step (){
    echo -e "\e[93m[+] $1\e[0m"
}
BASE64_STR=$1
PEM_FILE="/tmp/cert.pem"
write_step "Format string to a PEM file."
echo "-----BEGIN CERTIFICATE-----" > $PEM_FILE
echo $BASE64_STR >> $PEM_FILE
echo "-----END CERTIFICATE-----" >> $PEM_FILE
echo "" >> $PEM_FILE
echo "File '$PEM_FILE' created."
write_step "Certificate information:"
openssl x509 -noout -text -in $PEM_FILE -inform pem
