#!/bin/bash
#######################################################################
# Script to generate a ZIP archive with a specified level of deepness.
#######################################################################
if [ "$#" -lt 2 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [FILE_TO_STORE] [DEEPNESS]"
    echo ""
    echo "Call example:"
    echo "    $script_name test.bin 15"
    exit 1
fi
contained=$1
deep=$2
current_file="Level0.zip"
final_file="evil-archive-deep$deep.zip"
rm Level*.zip 2>/dev/null
zip -q $current_file $contained 
for level in $(seq 1 $deep)
do
	new_file="Level$level.zip"
	zip -q $new_file $current_file 
	current_file=$new_file	
done
mv $current_file $final_file
rm Level*.zip 2>/dev/null
file $final_file