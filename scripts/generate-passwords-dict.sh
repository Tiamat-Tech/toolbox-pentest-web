#!/bin/bash
#######################################################################
# Script to generate a dictionary of common passwords based on 
# several dictionaries from the SecLists GitHub repository
#######################################################################
SECLISTS_PASSWORDS_HOME="/tools/sec-lists/Passwords"
WORK="/tmp/dict.tmp"
RESULT="passwords.txt"
if [ "$#" -lt 1 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [ENTRY_COUNT]"
    echo ""
    echo "Call example:"
    echo "    $script_name 10000"
    exit 1
fi
limit=$1
rm $WORK 2>/dev/null
touch $WORK
passwords_dicts=( "darkweb2017-top10000.txt" "richelieu-french-top20000.txt" "xato-net-10-million-passwords-1000000.txt" )
for passwords_dict in "${passwords_dicts[@]}"
do
  cat $SECLISTS_PASSWORDS_HOME/$passwords_dict >> $WORK
done
cat $WORK | uniq -u | head -$limit > $RESULT
rm $WORK
file $RESULT
wc -l $RESULT