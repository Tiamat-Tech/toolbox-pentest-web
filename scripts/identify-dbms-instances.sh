#!/bin/bash
###
# Script to discover instances of SQL and NoSQL DBMS.
# Cf https://github.com/righettod/toolbox-pentest-web/blob/master/docs/3_HINTS_ON_SPECIFIC_TOPICS.md#dbms-default-connection-information
#    https://github.com/nmap/nmap/tree/master/scripts
###
target=$1
echo -e "\e[93m[+] SQL DBMS MSSQL/Sybase/OracleDB/MySQL/PostgreSQL ...\e[0m"
nmap --open -Pn -p 1433,2638,1521,1522,1523,3306,5432 --script broadcast-sybase-asa-discover,mysql-info,ms-sql-info,ms-sql-ntlm-info,oracle-tns-version,oracle-sid-brute -oG - $target
echo -e "\e[93m[+] NoSQL DBMS Redis/Cassandra/Neo4J/MongoDB ...\e[0m"
nmap --open -Pn -p 6379,7000,7001,7199,7473,7474,9042,27017,27018,27019 --script mongodb-info,redis-info,cassandra-info -oG - $target
